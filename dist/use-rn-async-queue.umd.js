!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("next-tick")):"function"==typeof define&&define.amd?define(["react","next-tick"],e):(n||self).useRnAsyncQueue=e(n.react,n.nextTick)}(this,function(n,e){function t(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var u=/*#__PURE__*/t(e);return function(e){const{done:t,drain:r,inflight:i}=e;let{concurrency:c}=e;c<1&&(c=Infinity);const[o,s]=n.useState({numPending:0,numInFlight:0,numDone:0}),f=n.useRef(!0),l=n.useRef([]),d=n.useRef([]);return n.useEffect(()=>{if(o.numDone>0&&r&&0===l.current.length&&0===d.current.length&&!f.current)return f.current=!0,u.default(r);for(;l.current.length<c&&d.current.length>0;){f.current=!1;const n=d.current.shift();l.current.push(n),s(n=>({...n,numPending:n.numPending-1,numInFlight:n.numInFlight+1})),i&&i({...n,stats:o});const e=n.task();e.then(()=>{l.current.pop(),s(n=>({...n,numInFlight:n.numInFlight-1,numDone:n.numDone+1})),t&&t({...n,result:e,stats:o})}).catch(()=>{l.current.pop(),s(n=>({...n,numInFlight:n.numInFlight-1,numDone:n.numDone+1})),t&&t({...n,result:e,stats:o})})}},[c,t,r,i,o]),{add:n.useCallback(n=>{d.current.push(n),s(n=>({...n,numPending:n.numPending+1}))},[]),stats:o}}});
//# sourceMappingURL=use-rn-async-queue.umd.js.map
