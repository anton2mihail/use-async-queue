!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("next-tick")):"function"==typeof define&&define.amd?define(["exports","react","next-tick"],e):e((n||self).useRnAsyncQueue={},n.react,n.nextTick)}(this,function(n,e,t){function u(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var r=/*#__PURE__*/u(t);n.useRnAsyncQueue=n=>{const{done:t,drain:u,inflight:i,isPaused:c}=n;let{concurrency:s}=n;s<1&&(s=Infinity);const[o,f]=e.useState({numPending:0,numInFlight:0,numDone:0}),l=e.useRef(!0),a=e.useRef([]),d=e.useRef([]);e.useEffect(()=>{if(!c){if(o.numDone>0&&u&&0===a.current.length&&0===d.current.length&&!l.current)return l.current=!0,r.default(u);for(;a.current.length<s&&d.current.length>0;){l.current=!1;const n=d.current.shift();a.current.push(n),f(n=>({...n,numPending:n.numPending-1,numInFlight:n.numInFlight+1})),i&&i({...n,stats:o});const e=n.task();e.then(()=>{a.current.pop(),f(n=>({...n,numInFlight:n.numInFlight-1,numDone:n.numDone+1})),t&&t({...n,result:e,stats:o})}).catch(()=>{a.current.pop(),f(n=>({...n,numInFlight:n.numInFlight-1,numDone:n.numDone+1})),t&&t({...n,result:e,stats:o})})}}},[s,t,u,i,o]);const h=e.useCallback(n=>{d.current.push(n),f(n=>({...n,numPending:n.numPending+1}))},[]);return{add:h,stats:o}}});
//# sourceMappingURL=use-rn-async-queue.umd.js.map
