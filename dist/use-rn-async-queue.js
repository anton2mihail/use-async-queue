var n=require("react");function t(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var e=/*#__PURE__*/t(require("next-tick"));module.exports=function(t){const{done:u,drain:r,inflight:c}=t;let{concurrency:i}=t;i<1&&(i=Infinity);const[s,l]=n.useState({numPending:0,numInFlight:0,numDone:0}),o=n.useRef(!0),m=n.useRef([]),a=n.useRef([]);return n.useEffect(()=>{if(s.numDone>0&&r&&0===m.current.length&&0===a.current.length&&!o.current)return o.current=!0,e.default(r);for(;m.current.length<i&&a.current.length>0;){o.current=!1;const n=a.current.shift();m.current.push(n),l(n=>({...n,numPending:n.numPending-1,numInFlight:n.numInFlight+1})),c&&c({...n,stats:s});const t=n.task();t.then(()=>{m.current.pop(),l(n=>({...n,numInFlight:n.numInFlight-1,numDone:n.numDone+1})),u&&u({...n,result:t,stats:s})}).catch(()=>{m.current.pop(),l(n=>({...n,numInFlight:n.numInFlight-1,numDone:n.numDone+1})),u&&u({...n,result:t,stats:s})})}},[i,u,r,c,s]),{add:n.useCallback(n=>{a.current.push(n),l(n=>({...n,numPending:n.numPending+1}))},[]),stats:s}};
//# sourceMappingURL=use-rn-async-queue.js.map
