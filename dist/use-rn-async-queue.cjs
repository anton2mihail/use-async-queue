var n=require("react");function e(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var t=/*#__PURE__*/e(require("next-tick"));exports.useRnAsyncQueue=function(e){const{done:u,drain:r,inflight:c}=e;let{concurrency:s}=e;s<1&&(s=Infinity);const[i,l]=n.useState({numPending:0,numInFlight:0,numDone:0}),o=n.useRef(!0),m=n.useRef([]),a=n.useRef([]);return n.useEffect(()=>{if(i.numDone>0&&r&&0===m.current.length&&0===a.current.length&&!o.current)return o.current=!0,t.default(r);for(;m.current.length<s&&a.current.length>0;){o.current=!1;const n=a.current.shift();m.current.push(n),l(n=>({...n,numPending:n.numPending-1,numInFlight:n.numInFlight+1})),c&&c({...n,stats:i});const e=n.task();e.then(()=>{m.current.pop(),l(n=>({...n,numInFlight:n.numInFlight-1,numDone:n.numDone+1})),u&&u({...n,result:e,stats:i})}).catch(()=>{m.current.pop(),l(n=>({...n,numInFlight:n.numInFlight-1,numDone:n.numDone+1})),u&&u({...n,result:e,stats:i})})}},[s,u,r,c,i]),{add:n.useCallback(n=>{a.current.push(n),l(n=>({...n,numPending:n.numPending+1}))},[]),stats:i}};
//# sourceMappingURL=use-rn-async-queue.cjs.map
